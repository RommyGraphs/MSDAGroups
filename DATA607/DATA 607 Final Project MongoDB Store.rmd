---
title: "DATA 607 Final Project - MongoDB Store"
author: "Jason Givens-Doyle, Romerl Elizes & Soumya Ghosh"
date: "December 12, 2018"
output: 
  html_document: 
    toc: true
    df_print: kable
    theme: cerulean
    highlight: pygments
    css: ./lab.css
  #  code_folding:hide
  pdf_document: default
---

### Part II - Storing Data in MongoDB -  Summary


Before we decided on where to store the data, I created a script that stored that data in MongoDB. This is important because we wanted to make sure that we could store the data in a suitable database infrastructure.


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r message=FALSE, warning=FALSE}
library(RODBC)
library(mongolite)
library(knitr)
library(kableExtra)
library(stringr)
library(dplyr)
library(tidyr)
library(scales)
library(ggplot2)
library(plotly)
library(maps)
library(mapdata)
library(ggrepel) #not using this at the moment, but it does give the option to add labels.  While not useful for the 
```


### A. Connecting to the Database

First we have to connect to an existing Mongo database. It is assumed that the mongo database is already running on the machine and is ready to accept connections. We have to drop all the tables prior to loading the data again to make sure that the data we are storing is clean and there are no duplicates.

```{r connect-to-mongodatabase, eval=TRUE}
mbreast <- mongo("breast")
mdigothr <- mongo("digothr")
mmalegen <- mongo("malegen")
mfemgen <- mongo("femgent")
mother <- mongo("other")
mrespir <- mongo("respir")
mcolrect <- mongo("colrect")
mlymyleuk <- mongo("lymyleuk")
murinary <- mongo("urinary")

mbreast$drop()
mdigothr$drop()
mmalegen$drop()
mfemgen$drop()
mother$drop()
mrespir$drop()
mcolrect$drop()
mlymyleuk$drop()
murinary$drop()
```

### B. Storing CSV Data into Mongo Database

This was a pretty straightforward set of commands. The process repeats itself for all parsed SEER Cancer data. For each CSV file, we opened it and stored the data in its appropriate collection.

```{r work2}
# Open up each CSV file and store in mongodb

dfbreast = read.csv("c:/SEER/output/breast.csv")
mbreast$insert(dfbreast)
print("Finished loading BREAST CANCER data.")

dfdigothr = read.csv("c:/SEER/output/digothr.csv")
mdigothr$insert(dfdigothr)
print("Finished loading OTHER DIGESTIVE CANCER data.")

dfmalegen = read.csv("c:/SEER/output/malegen.csv")
mmalegen$insert(dfmalegen)
print("Finished loading MALE GENITAL CANCER data.")

dffemgen = read.csv("c:/SEER/output/femgen.csv")
mfemgen$insert(dffemgen)
print("Finished loading FEMALE GENITAL CANCER data.")

dfother = read.csv("c:/SEER/output/other.csv")
mother$insert(dfother)
print("Finished loading OTHER SITES CANCER data.")

dfrespir = read.csv("c:/SEER/output/respir.csv")
mrespir$insert(dfrespir)
print("Finished loading RESPIRATORY CANCER data.")

dfcolrect = read.csv("c:/SEER/output/colrect.csv")
mcolrect$insert(dfcolrect)
print("Finished loading COLON AND RECTAL CANCER data.")

dflymyleuk = read.csv("c:/SEER/output/lymyleuk.csv")
mlymyleuk$insert(dflymyleuk)
print("Finished loading LYMPHOMA AND LEUKEMIA CANCER data.")

dfurinary = read.csv("c:/SEER/output/urinary.csv")
murinary$insert(dfurinary)
print("Finished loading URINARY CANCER data.")

print("Finished MongoDB load of CSV files!")
```



